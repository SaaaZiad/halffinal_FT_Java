CREATE TABLE users (
user_id BIGSERIAL PRIMARY KEY,
username VARCHAR(255) NOT NULL,
role VARCHAR(50) DEFAULT 'CLIENT',
password VARCHAR(100) CHECK (LENGTH(password) >= 6 AND LENGTH(password) <= 100),
balance BIGINT DEFAULT 0
);

CREATE TABLE tickets (
ticket_id BIGSERIAL PRIMARY KEY,
destination VARCHAR(255) NOT NULL,
departure VARCHAR(255) NOT NULL,
description VARCHAR(255) NOT NULL,
departure_time TIMESTAMP NOT NULL,
arrival_time TIMESTAMP NOT NULL,
str_dep_time VARCHAR(255) NOT NULL,
str_arr_time VARCHAR(255) NOT NULL,
transport_type VARCHAR(255) NOT NULL,
price BIGINT NOT NULL CHECK (price >= 1),
amount INTEGER NOT NULL CHECK (amount >= 0)
);

CREATE TABLE orders (
order_id BIGSERIAL PRIMARY KEY,
amount INTEGER,
user_id BIGINT NOT NULL,
ticket_id BIGINT NOT NULL,
FOREIGN KEY (user_id) REFERENCES users(user_id),
FOREIGN KEY (ticket_id) REFERENCES tickets(ticket_id)
);

INSERT INTO users (username, password, role, balance) VALUES
('admin_user', 'secure_password_hash1', 'ADMIN', 5000),
('regular_user1', 'secure_password_hash2', 'USER', 1500),
('regular_user2', 'secure_password_hash3', 'USER', 2500),
('zero_balance_user', 'secure_password_hash4', 'USER', 0),
('premium_user', 'secure_password_hash5', 'USER', 10000);

INSERT INTO tickets (transportType, departure, destination, departureTime, arrivalTime, strDepTime, strArrTime, price, description, amount) VALUES
-- Авиабилеты
('Авиа', 'Москва', 'Санкт-Петербург', '2023-12-15 08:30:00', '2023-12-15 10:00:00', '15.12.2023 08:30', '15.12.2023 10:00', 5500, 'Прямой рейс, эконом-класс', 100),
('Авиа', 'Москва', 'Сочи', '2023-12-18 12:15:00', '2023-12-18 14:45:00', '18.12.2023 12:15', '18.12.2023 14:45', 7800, 'Прямой рейс, включен багаж', 2),
('Авиа', 'Екатеринбург', 'Москва', '2023-12-20 06:45:00', '2023-12-20 08:20:00', '20.12.2023 06:45', '20.12.2023 08:20', 6200, 'Утренний рейс, бизнес-класс', 10),
('Авиа', 'Новосибирск', 'Краснодар', '2023-12-22 15:30:00', '2023-12-22 19:45:00', '22.12.2023 15:30', '22.12.2023 19:45', 9500, 'С пересадкой в Москве', 10),
('Авиа', 'Казань', 'Владивосток', '2023-12-25 23:10:00', '2023-12-26 11:30:00', '25.12.2023 23:10', '26.12.2023 11:30', 15200, 'Ночной рейс, комфорт-класс', 10),
('Авиа', 'Санкт-Петербург', 'Калининград', '2023-12-28 10:20:00', '2023-12-28 11:40:00', '28.12.2023 10:20', '28.12.2023 11:40', 4800, 'Прямой рейс, без багажа', 50),
('Авиа', 'Москва', 'Мурманск', '2024-01-05 09:15:00', '2024-01-05 11:45:00', '05.01.2024 09:15', '05.01.2024 11:45', 8300, 'Новогодний специальный рейс', 1),

-- ЖД билеты
('ЖД', 'Москва', 'Нижний Новгород', '2023-12-16 07:40:00', '2023-12-16 11:30:00', '16.12.2023 07:40', '16.12.2023 11:30', 2300, 'Скоростной поезд "Сапсан", 2 класс', 2),
('ЖД', 'Санкт-Петербург', 'Москва', '2023-12-19 14:00:00', '2023-12-19 18:10:00', '19.12.2023 14:00', '19.12.2023 18:10', 2700, 'Фирменный поезд "Красная стрела", купе', 5),
('ЖД', 'Краснодар', 'Ростов-на-Дону', '2023-12-21 09:20:00', '2023-12-21 12:40:00', '21.12.2023 09:20', '21.12.2023 12:40', 1200, 'Пригородный экспресс', 40),
('ЖД', 'Екатеринбург', 'Тюмень', '2023-12-23 16:45:00', '2023-12-23 20:15:00', '23.12.2023 16:45', '23.12.2023 20:15', 1800, 'Плацкарт, нижнее место', 5),
('ЖД', 'Москва', 'Казань', '2023-12-26 22:30:00', '2023-12-27 08:45:00', '26.12.2023 22:30', '27.12.2023 08:45', 3500, 'Ночной поезд, СВ', 1),
('ЖД', 'Новосибирск', 'Красноярск', '2023-12-29 11:15:00', '2023-12-29 18:30:00', '29.12.2023 11:15', '29.12.2023 18:30', 2100, 'Дневной экспресс, сидячий вагон', 30),
('ЖД', 'Самара', 'Уфа', '2024-01-03 05:30:00', '2024-01-03 11:20:00', '03.01.2024 05:30', '03.01.2024 11:20', 1950, 'Утренний рейс, купе', 10),

-- Автобусные билеты
('Автобус', 'Москва', 'Тула', '2023-12-17 10:00:00', '2023-12-17 12:30:00', '17.12.2023 10:00', '17.12.2023 12:30', 850, 'Комфортабельный автобус, Wi-Fi', 15),
('Автобус', 'Санкт-Петербург', 'Выборг', '2023-12-20 08:15:00', '2023-12-20 10:00:00', '20.12.2023 08:15', '20.12.2023 10:00', 650, 'Экспресс-маршрут', 5),
('Автобус', 'Краснодар', 'Анапа', '2023-12-22 12:45:00', '2023-12-22 15:30:00', '22.12.2023 12:45', '22.12.2023 15:30', 920, 'Туристический автобус с кондиционером', 20),
('Автобус', 'Казань', 'Набережные Челны', '2023-12-24 14:30:00', '2023-12-24 17:15:00', '24.12.2023 14:30', '24.12.2023 17:15', 780, 'Стандартный маршрут', 3),
('Автобус', 'Нижний Новгород', 'Владимир', '2023-12-27 09:40:00', '2023-12-27 12:20:00', '27.12.2023 09:40', '27.12.2023 12:20', 720, 'Автобус с повышенной комфортностью', 6),
('Автобус', 'Екатеринбург', 'Челябинск', '2023-12-30 16:00:00', '2023-12-30 19:30:00', '30.12.2023 16:00', '30.12.2023 19:30', 950, 'Вечерний рейс, мягкие сиденья', 7),
('Автобус', 'Сочи', 'Адлер', '2024-01-02 11:30:00', '2024-01-02 12:15:00', '02.01.2024 11:30', '02.01.2024 12:15', 350, 'Пригородный маршрут, частые остановки', 8);

INSERT INTO orders (user_id, ticket_id, amount) VALUES
(1, 1, 3),
(1, 8, 1),
(1, 15, 5),

(2, 2, 1),
(2, 9, 2),

(3, 3, 2),
(3, 16, 1),
(3, 10, 10),

(4, 4, 3),
(4, 17, 5),

(5, 5, 1),
(5, 11, 1);